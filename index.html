<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TzInstruments - Configurator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" integrity="sha384-4LISF5TTJX/fLmGSxO53rV4miRxdg84mZsxmO8Rx5jGtp/LbrixFETvWa5a6sESd" crossorigin="anonymous">
</head>
  <body>
    <nav class="navbar navbar-expand-lg bg-dark" data-bs-theme="dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">TzInstruments</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="#">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://github.com/Martenz/T-Display-S3-AMOLED" target="_blank"><i class="bi bi-github"> </i>GitHub</a>
              </li>
            </ul>
            <form class="d-flex" role="search">
              <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success" type="submit">Search</button>
            </form>
          </div>
        </div>
      </nav>

    <div class="container-fluid mx-6 bg-light text-center">
      <h3 class="py-3">S3 - OLED GPS Acoustic Altivario BLE - Configuration Export</h3>
      <h4 class="p-3">Configure here your TzInstrument</h4>
    </div>

    <div class="container-sm pb-5">
        <h5>Step 1</h5>
        <p>Import from json files here</p>
        <input type="file" id="import-file" class="form-control w-50 d-inline-block">
        <button id="import-settings" class="btn btn-outline-primary mb-2 center" type="button">Import</button>        

        <p>and/or Edit</p>
        <div class="accordion" id="accordionExample">
          <div class="accordion-item">
            <h2 class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                General Settings
              </button>
            </h2>
            <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
              <div class="accordion-body">
                <div id="S3-OLED" class="px-5 row">
                  <form id="formData">
                    <!-- WiFi Name -->
                    <div class="row g-3 align-items-center">
                      <div class="col-3">
                        <label for="wifi_ssid" class="col-form-label">WiFi SSID Name</label>
                      </div>
                      <div class="col-3">
                        <input type="text" id="wifi_ssid" name="wifi_ssid" class="form-control setting" value="My-SSID">
                      </div>
                      <div class="col-6">
                        <span class="form-text">
                          Your WiFi SSID name to connect for automatic updates.
                        </span>
                      </div>
                    </div>
                    <!-- WiFi Password -->
                    <div class="row g-3 align-items-center">
                      <div class="col-3">
                        <label for="wifi_psw" class="col-form-label">WiFi Password</label>
                      </div>
                      <div class="col-3">
                        <input type="text" id="wifi_psw" name="wifi_psw" class="form-control setting" value="My-PSW">
                      </div>
                      <div class="col-6">
                        <span class="form-text">
                          Your WiFi SSID password to connect for automatic updates.
                        </span>
                      </div>
                    </div>
                    <!-- volume -->
                  <div class="row g-3 align-items-center">
                    <div class="col-3">
                      <label for="volume" class="col-form-label">Volume</label>
                    </div>
                    <div class="col-3">
                      <select id="volume" name="volume" class="form-select setting numeric" aria-label="Default select example">
                        <option selected>Select</option>
                        <option value=0 selected>OFF</option>
                        <option value=1>Low</option>
                        <option value=2>High</option>
                      </select>
                    </div>
                    <div class="col-6">
                      <span class="form-text">
                        Buzzer volume.
                      </span>
                    </div>
                  </div>
                  <!-- gps_hz -->
                  <div class="row g-3 align-items-center">
                    <div class="col-3">
                      <label for="inputPassword6" class="col-form-label">GPS Hz</label>
                    </div>
                    <div class="col-3">
                      <select id="gps_hz" name="gps_hz" class="form-select setting numeric" aria-label="Default select example">
                        <option selected>Select</option>
                        <option value=1 >1</option>
                        <option value=5 selected>5</option>
                        <option value=10>10</option>
                      </select>
                    </div>
                    <div class="col-6">
                      <span class="form-text">
                        GPS update frequemncy Hz.
                      </span>
                    </div>
                  </div>
                  <!-- min_sat_av -->
                  <div class="row g-3 align-items-center">
                    <div class="col-3">
                      <label for="inputPassword6" class="col-form-label">Min Sat</label>
                    </div>
                    <div class="col-3">
                      <select id="min_sat_av" name="min_sat_av" class="form-select setting numeric" aria-label="Default select example">
                        <option selected>Select</option>
                        <option value=4 >4</option>
                        <option value=5 selected>5</option>
                        <option value=6>6</option>
                      </select>
                    </div>
                    <div class="col-6">
                      <span class="form-text">
                        Minimum number of satellites for GPS validation.
                      </span>
                    </div>
                  </div>
                  <!-- rotation -->
                  <div class="row g-3 align-items-center">
                    <div class="col-3">
                      <label for="inputPassword6" class="col-form-label">Display Rotation</label>
                    </div>
                    <div class="col-3">
                      <select id="rotation" name="rotation" class="form-select setting numeric" aria-label="Default select example">
                        <option selected>Select</option>
                        <option value=0 >0</option>
                        <option value=1 selected>90°</option>
                        <option value=2>180°</option>
                        <option value=3>270°</option>
                      </select>
                    </div>
                    <div class="col-6">
                      <span class="form-text">
                        Display orientation.
                      </span>
                    </div>
                  </div>
                  <!-- thermal_detect -->
                  <div class="row g-3 align-items-center">
                    <div class="col-3">
                      <label for="flexSwitchCheckDefault" class="col-form-label">Thermal Detect</label>
                    </div>
                    <div class="col-3">
                      <div class="form-check form-switch">
                        <input id="thermal_detect" name="thermal_detect" class="form-check-input setting" type="checkbox" role="switch">
                        <label class="form-check-label" for="flexSwitchCheckDefault">Detect</label>
                      </div>
                    </div>
                    <div class="col-6">
                      <span class="form-text">
                        If enabled it detects thermalling and use average vario averaging in ms.
                      </span>
                    </div>
                  </div>
                  <!-- thermal_avg -->
                  <div class="row g-3 align-items-center">
                    <div class="col-3">
                      <label for="flexSwitchCheckDefault" class="col-form-label">Thermal averaging</label>
                    </div>
                    <div class="col-3">
                      <input type="number" id="thermal_avg" name="thermal_avg" class="form-control setting" value="2000" min="50" max="5000" step="50">
                    </div>
                    <div class="col-6">
                      <span class="form-text">
                        Vario avergaing in milliseconds if thermalling, min 50 ms up to 5000 ms max.
                      </span>
                    </div>
                  </div>
                  <!-- vario_lift_on -->
                  <div class="row g-3 align-items-center">
                    <div class="col-3">
                      <label for="flexSwitchCheckDefault" class="col-form-label">Vario Buzzer Lift On</label>
                    </div>
                    <div class="col-3">
                      <input type="number" id="vario_lift_on" name="vario_lift_on" class="form-control setting" value="0.0" min="-10" max="10" step="0.1">
                    </div>
                    <div class="col-6">
                      <span class="form-text">
                        Vario buzzer lift threshold, buzzer will be on for values greater than this value.
                      </span>
                    </div>
                  </div>
                  <!-- vario_sink_on -->
                  <div class="row g-3 align-items-center">
                    <div class="col-3">
                      <label for="flexSwitchCheckDefault" class="col-form-label">Vario Buzzer Sink Off</label>
                    </div>
                    <div class="col-3">
                      <input type="number" id="vario_sink_on" name="vario_sink_on" class="form-control setting" value="-2.9" min="-10" max="10" step="0.1">
                    </div>
                    <div class="col-6">
                      <span class="form-text">
                        Vario buzzer sink threshold, buzzer will be off for values from Vario Buzzer Lift On to this value.
                      </span>
                    </div>
                  </div>
                  <!-- vario_avg_ms -->
                  <div class="row g-3 align-items-center">
                    <div class="col-3">
                      <label for="flexSwitchCheckDefault" class="col-form-label">Vario Avergaing Display</label>
                    </div>
                    <div class="col-3">
                      <input type="number" id="vario_avg_ms" name="vario_avg_ms" class="form-control setting" value="250" min="50" max="5000" step="50">
                    </div>
                    <div class="col-6">
                      <span class="form-text">
                        Vario averaging in milliseconds for display value.
                      </span>
                    </div>
                  </div>
                  <!-- vario_avg_ms_b -->
                  <div class="row g-3 align-items-center">
                    <div class="col-3">
                      <label for="flexSwitchCheckDefault" class="col-form-label">Vario Averaging Buzzer</label>
                    </div>
                    <div class="col-3">
                      <input type="number" id="vario_avg_ms_b" name="vario_avg_ms_b" class="form-control setting" value="50" min="50" max="5000" step="50">
                    </div>
                    <div class="col-6">
                      <span class="form-text">
                        Vario averaging in milliseconds for buzzer value.
                      </span>
                    </div>
                  </div>
                </form>

                </div>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header accordion-bg-dark">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                Vario Curve Editor
              </button>
            </h2>
            <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
              <div class="accordion-body">
                <div id="S3-OLED-VARIO-CURVE">
                  <canvas id="chart" style="width:100%;max-width:2000px"></canvas>
                  <input id="vario-test" class="form-control bg-light" type="range" min="-10" max="10" value="0" step="0.1" style="width: 93%;
                  margin: auto;">
                  <output id="vario-test-value" class="text-center w-100" value="0" for="vario-test">0.0</output>
                  <button class="btn btn-dark w-100" id="play">Test Sound</button>
                  <textarea id="vario_curve" class="mt-3" readonly style="display: none;width:100%" rows="5"></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
    </div>

    <div class="container-sm pb-5">
      <h5>Step 2 - Generate or Export your settings:</h5>
      <button id="generate-settings" class="btn btn-primary mb-2 center" type="button">Generate</button>
      <button id="export-settings" class="btn btn-outline-success mb-2 center" type="button">Export</button>
      <div id="generated-settings" style="display:none">
        <textarea id="generated-settings-text" readonly rows="10" style="width: 100%;"></textarea>
        <button id="copy-generated-settings-text" type="button" class="btn btn-outline-success mb-2 center">
          <i class="bi bi-copy"> </i> Copy
        </button>
      </div>
    </div>

    <div class="container-sm pb-5">
      <h5>Step 3 - Upload to your TzInstrument:</h5>
      <ul>
        <li>Enable WiFi AP on your TzInstrument while pressing Button 1 for more than 3 seconds.</li>
        <li>Search on your PC/Tablet/Phone the TzI Wifi Access point and connect to it (no password).</li>
        <li>Visit this IP <a href="http://192.168.4.1" target="_blank">192.168.4.1</a> on your browser.</li>
        <li>Paste your Generates Settings form here to there and press "Update Settings" button.</li>
      </ul>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-dragdata@2.2.3/dist/chartjs-plugin-dragdata.min.js"></script>
    <script src="./main.js"></script>
  </body>
</html>